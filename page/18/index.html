<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
    <title>dev notes</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/gitment.css">
    <link rel="stylesheet" href="/css/font_859455_eaq7v6w8ktj.css">
</head>

<body>
<header class="header">
    <div class="header-inner">
        <div class="header-title">

        </div>
        <nav class="header-nav">
            
            <a href="/" class="header-nav-link">
                Home
            </a>
            

            
            <a href="/archives" class="header-nav-link">
                Archives
            </a>
            

            
            <a href="/tags" class="header-nav-link">
                Tags
            </a>
            

            
        </nav>
    </div>
</header>
<header class="mobile-header">
    <div class="mobile-nav">
        <div class="mobile-nav-icon">
            <span></span>
            <span></span>
            <span></span>
        </div>
        <div class="mobile-nav-title">
            <a href="/" class="mobile-nav-title-link">Frank Gutierrez's Blog</a>
        </div>

    </div>
    <nav class="mobile-menu">
        <ul class="mobile-menu-list">
            <li class="mobile-menu-item">
                <i class="iconfont icon-home"></i>
                <a href="/" class="mobile-nav-link">Home</a>
            </li>
            <li class="mobile-menu-item">
                <i class="iconfont icon-archive"></i>
                <a href="/archives" class="mobile-nav-link">Archives</a>
            </li>
            <li class="mobile-menu-item">
                <i class="iconfont icon-tag"></i>
                <a href="/tags" class="mobile-nav-link">Tags</a>
            </li>
            <li class="mobile-menu-item">
                <i class="iconfont icon-about"></i>
                <a href="/about/" class="mobile-nav-link">About</a>
            </li>
        </ul>
    </nav>
</header>
<div class="main">
    <div class="content-inner">
        <div class="posts">
    
        <article class="post-abstract">
            <div class="post-title">
                <h2><a class="post-title-link" href="/2016/11/15/2016/20161115-docker-learn-by-example/">Docker – Learn By Example</a></h2>
            </div>
            <div class="post-meta">
                <span class="post-time">2016-11-15</span>
                
            </div>
            <div class="post-content">
                
                    <h1 id="Docker-––-Learn-By-Example"><a href="#Docker-––-Learn-By-Example" class="headerlink" title="Docker –– Learn By Example"></a>Docker –– Learn By Example</h1><p><a href="https://goo.gl/F5ZTQS" target="_blank" rel="noopener">source material</a></p>
<!-- TOC depthFrom:1 depthTo:3 withLinks:0 updateOnSave:1 orderedList:0 -->
<ul>
<li>Docker –– Learn By Example<ul>
<li>run apps in a container (interactive, daemonized)</li>
<li>working with containers</li>
<li>Create your own images<ul>
<li>Updating and committing an image</li>
<li>Building an image from a Dockerfile</li>
</ul>
</li>
<li>network containers</li>
<li>manage data in containers</li>
<li>store images on Docker Hub</li>
</ul>
</li>
</ul>
<!-- /TOC -->
<h2 id="run-apps-in-a-container-interactive-daemonized"><a href="#run-apps-in-a-container-interactive-daemonized" class="headerlink" title="run apps in a container (interactive, daemonized)"></a>run apps in a container (interactive, daemonized)</h2><ul>
<li>run “hello frankg”</li>
<li>run interactive shell</li>
<li>run daemonized app</li>
<li>show logs</li>
<li>stop container</li>
<li>remove container</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">// run &quot;hello frankg&quot; in a container</span><br><span class="line">docker run ubuntu /bin/echo &quot;hello frankg&quot;</span><br><span class="line">  hello frankg</span><br><span class="line"></span><br><span class="line">// run an interactive container</span><br><span class="line">docker -it ubuntu bash</span><br><span class="line">  docker run -it ubuntu bash</span><br><span class="line">  root@304485fae978:/# exit</span><br><span class="line"></span><br><span class="line">// run daemonized &quot;hello frankg&quot;</span><br><span class="line">docker run -d ubuntu /bin/sh -c  &quot;while true; do echo hello frankg; sleep 2; done&quot;</span><br><span class="line"></span><br><span class="line">// show container logs</span><br><span class="line">docker logs -f 939fc7a0ebf7070</span><br><span class="line">hello frankg</span><br><span class="line">hello frankg</span><br><span class="line">[...]</span><br><span class="line"></span><br><span class="line">// stop container</span><br><span class="line">docker stop 939fc7a0ebf7070</span><br><span class="line"></span><br><span class="line">// remove container</span><br><span class="line">docker rm 939fc7a0ebf7070</span><br></pre></td></tr></table></figure>
<h2 id="working-with-containers"><a href="#working-with-containers" class="headerlink" title="working with containers"></a>working with containers</h2><ul>
<li>show docker client/server versions</li>
<li>use docker help</li>
<li>run nginx with name web</li>
<li>get ports</li>
<li>get logs</li>
<li>get processes</li>
<li>inspect container</li>
<li>inspect range in container</li>
<li>stop container</li>
<li>restart container</li>
<li>remove container</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">// use docker client</span><br><span class="line">docker version</span><br><span class="line">  Client:</span><br><span class="line">   Version:      1.12.1</span><br><span class="line">   [...]</span><br><span class="line">  Server:</span><br><span class="line">   Version:      1.12.1</span><br><span class="line">   [...]</span><br><span class="line"></span><br><span class="line">// use docker help</span><br><span class="line">docker --help</span><br><span class="line">[...]</span><br><span class="line"></span><br><span class="line">// run a web app</span><br><span class="line">docker run -d -P --name web nginx</span><br><span class="line"></span><br><span class="line">// get container ports</span><br><span class="line">docker port web</span><br><span class="line">  443/tcp -&gt; 0.0.0.0:32776</span><br><span class="line">  80/tcp -&gt; 0.0.0.0:32777</span><br><span class="line"></span><br><span class="line">// tail logs</span><br><span class="line">docker logs -f web</span><br><span class="line"></span><br><span class="line">// get container processes</span><br><span class="line">docker top web</span><br><span class="line">  [...]</span><br><span class="line"></span><br><span class="line">// inspect container</span><br><span class="line">docker inspect web</span><br><span class="line">  [...json...]</span><br><span class="line"></span><br><span class="line">// inspect range</span><br><span class="line">docker inspect -f &apos;&#123;&#123;range .NetworkSettings.Networks&#125;&#125;&#123;&#123;.IPAddress&#125;&#125;&#123;&#123;end&#125;&#125;&apos; web</span><br><span class="line">  172.17.0.3</span><br><span class="line"></span><br><span class="line">// stop container</span><br><span class="line">docker stop web</span><br><span class="line"></span><br><span class="line">// restart container</span><br><span class="line">docker restart web</span><br><span class="line"></span><br><span class="line">// remove container</span><br><span class="line">docker rm web</span><br></pre></td></tr></table></figure>
<h2 id="Create-your-own-images"><a href="#Create-your-own-images" class="headerlink" title="Create your own images"></a>Create your own images</h2><h3 id="Updating-and-committing-an-image"><a href="#Updating-and-committing-an-image" class="headerlink" title="Updating and committing an image"></a>Updating and committing an image</h3><p>Goal: clone nginx image and edit it to show new html page</p>
<ul>
<li>list images on host</li>
<li>find image</li>
<li>get new nginx image</li>
<li>tag nginx image to clone it</li>
<li>run bash interactively</li>
<li>edit html page and exit</li>
<li>collect container id</li>
<li>collect nginx cmd</li>
<li>commit to new image</li>
<li>note new image id</li>
<li>test new image to see change</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">// list images on host</span><br><span class="line">docker images</span><br><span class="line">  [...]</span><br><span class="line"></span><br><span class="line">// find image</span><br><span class="line">docker search nginx</span><br><span class="line"></span><br><span class="line">// get a new image</span><br><span class="line">docker pull nginx</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// tag image to clone it and preserve the original</span><br><span class="line"></span><br><span class="line">    docker tag nginx frankg/nginx:v2</span><br><span class="line"></span><br><span class="line">// open terminal to container:</span><br><span class="line"></span><br><span class="line">    docker run -it frankg/nginx:v2 bash</span><br><span class="line"></span><br><span class="line">// edit index.html file and exit</span><br><span class="line"></span><br><span class="line">    sed -i -e &apos;s/using nginx\./using nginx!!!/&apos; /usr/share/nginx/html/index.html</span><br><span class="line">    exit</span><br><span class="line"></span><br><span class="line">// note the container id</span><br><span class="line"></span><br><span class="line">    docker ps -a</span><br><span class="line">      CONTAINER_ID  ...</span><br><span class="line">      c56ba35f9441  ...</span><br><span class="line"></span><br><span class="line">// note the command used for nginx</span><br><span class="line"></span><br><span class="line">      docker inspect nginx</span><br><span class="line">        [...]</span><br><span class="line">        &quot;Cmd&quot;: [</span><br><span class="line">            &quot;nginx&quot;,</span><br><span class="line">            &quot;-g&quot;,</span><br><span class="line">            &quot;daemon off;&quot;</span><br><span class="line">        ],</span><br><span class="line">        [...]</span><br><span class="line"></span><br><span class="line">// commit to new image</span><br><span class="line"></span><br><span class="line">    docker commit \</span><br><span class="line">    --change=&apos;CMD [&quot;nginx&quot;, &quot;-g&quot;, &quot;daemon off;&quot;]&apos; \</span><br><span class="line">    -m &quot;change splash page&quot; \</span><br><span class="line">    -a &quot;Frank Gutierrez&quot; \</span><br><span class="line">    c56ba35f9441 frankg/nginx:v2</span><br><span class="line"></span><br><span class="line">// note new image has a different IMAGE_ID</span><br><span class="line"></span><br><span class="line">    docker images</span><br><span class="line">      REPO              IMAGE_ID</span><br><span class="line">      frankg/nginx:v2   9c29fe606e58</span><br><span class="line">      nginx:latest      05a60462f8ba</span><br><span class="line"></span><br><span class="line">// test new image</span><br><span class="line"></span><br><span class="line">    docker run -d --name web -p 5000:80 frankg/nginx:v2</span><br><span class="line">    curl localhost:5000</span><br><span class="line">      &lt;p&gt;&lt;em&gt;Thank you for using nginx!!!&lt;/em&gt;&lt;/p&gt;</span><br></pre></td></tr></table></figure>
<h3 id="Building-an-image-from-a-Dockerfile"><a href="#Building-an-image-from-a-Dockerfile" class="headerlink" title="Building an image from a Dockerfile"></a>Building an image from a Dockerfile</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">// goto project directory</span><br><span class="line"></span><br><span class="line">    mkdir sinatra</span><br><span class="line">    cd sinatra</span><br><span class="line"></span><br><span class="line">// create Dockerfile</span><br><span class="line"></span><br><span class="line">    # This is a comment</span><br><span class="line">    FROM ubuntu:14.04</span><br><span class="line">    MAINTAINER Kate Smith &lt;ksmith@example.com&gt;</span><br><span class="line">    RUN apt-get update &amp;&amp; apt-get install -y ruby ruby-dev</span><br><span class="line">    RUN gem install sinatra</span><br><span class="line"></span><br><span class="line">// build image</span><br><span class="line"></span><br><span class="line">    docker build -t frankg/sinatra:v2 .</span><br><span class="line"></span><br><span class="line">// create tags</span><br><span class="line"></span><br><span class="line">    docker tag 80ace061969c frankg/sinatra:devel</span><br><span class="line">    docker tag 80ace061969c frankg/sinatra:latest</span><br><span class="line"></span><br><span class="line">// show digests</span><br><span class="line"></span><br><span class="line">    docker images --digests</span><br><span class="line">        DIGEST</span><br><span class="line">        &lt;none&gt;   // you see &lt;none&gt; because of a docker bug - to be fixed</span><br><span class="line">        sha256:dac37bad0c870a81605abf3f652ebd713fd4c4e33448362ae61f34369ac81412</span><br><span class="line"></span><br><span class="line">// push to docker hub</span><br><span class="line"></span><br><span class="line">    docker push frankg/sinatra</span><br><span class="line"></span><br><span class="line">// remove image</span><br><span class="line"></span><br><span class="line">    docker rmi -f frankg/sinatra</span><br></pre></td></tr></table></figure>
<h2 id="network-containers"><a href="#network-containers" class="headerlink" title="network containers"></a>network containers</h2><ul>
<li>list networks</li>
<li>launch container on default network</li>
<li>inspect default bridge network</li>
<li>inspect container’s networks section</li>
<li>inspect container’s IPAddress section</li>
<li>stop and remove container</li>
<li>create your own bridge network</li>
<li>add container to your network</li>
<li>inspect container’s networks section</li>
<li>inspect container’s IPAddress section</li>
<li>disconnect container from your network</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">// list networks</span><br><span class="line"></span><br><span class="line">    docker network ls</span><br><span class="line"></span><br><span class="line">      NETWORK ID          NAME                DRIVER              SCOPE</span><br><span class="line">      6dc32a4596cb        bridge              bridge              local</span><br><span class="line">      cf9fd2482051        host                host                local</span><br><span class="line">      847fc736b59b        none                null                local</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// launch a container on the default network</span><br><span class="line"></span><br><span class="line">    docker run -d --name web nginx</span><br><span class="line"></span><br><span class="line">// inspect default bridge network</span><br><span class="line"></span><br><span class="line">    docker network inspect bridge</span><br><span class="line"></span><br><span class="line">      [...]</span><br><span class="line">      &quot;Containers&quot;: &#123;</span><br><span class="line">        [...]</span><br><span class="line">        &quot;e979b69c6ac4c177628582c84a796507cd716f3fd2eed825d06051fb43bc3865&quot;: &#123;</span><br><span class="line">            &quot;Name&quot;: &quot;web&quot;,</span><br><span class="line">      [...]</span><br><span class="line"></span><br><span class="line">// inspect networks section</span><br><span class="line"></span><br><span class="line">    docker inspect --format=&apos;&#123;&#123;json .NetworkSettings.Networks&#125;&#125;&apos; web</span><br><span class="line"></span><br><span class="line">      [...]</span><br><span class="line">      &quot;Containers&quot;: &#123;</span><br><span class="line">        [...]</span><br><span class="line">        &quot;e979b69c6ac4c177628582c84a796507cd716f3fd2eed825d06051fb43bc3865&quot;: &#123;</span><br><span class="line">            &quot;Name&quot;: &quot;web&quot;,</span><br><span class="line">      [...]</span><br><span class="line"></span><br><span class="line">// inspect IPAddress section</span><br><span class="line"></span><br><span class="line">    docker inspect --format=&apos;&#123;&#123;range .NetworkSettings.Networks&#125;&#125;&#123;&#123;.IPAddress&#125;&#125;&#123;&#123;end&#125;&#125;&apos; web</span><br><span class="line"></span><br><span class="line">      172.17.0.3</span><br><span class="line"></span><br><span class="line">// stop and remove container</span><br><span class="line"></span><br><span class="line">    docker stop web ; docker rm web</span><br><span class="line"></span><br><span class="line">// create your own bridge network</span><br><span class="line"></span><br><span class="line">    docker network create -d bridge my-bridge-network</span><br><span class="line"></span><br><span class="line">// add containers to your network</span><br><span class="line"></span><br><span class="line">    docker run -d -p 5000:80 --network=my-bridge-network --name=web nginx</span><br><span class="line"></span><br><span class="line">// inspect networks section</span><br><span class="line"></span><br><span class="line">    docker inspect --format=&apos;&#123;&#123;json .NetworkSettings.Networks&#125;&#125;&apos;  web</span><br><span class="line"></span><br><span class="line">      &#123;&quot;my-bridge-network&quot;:...</span><br><span class="line"></span><br><span class="line">// inspect IPAddress section</span><br><span class="line"></span><br><span class="line">    docker inspect --format=&apos;&#123;&#123;range .NetworkSettings.Networks&#125;&#125;&#123;&#123;.IPAddress&#125;&#125;&#123;&#123;end&#125;&#125;&apos; web</span><br><span class="line"></span><br><span class="line">      172.18.0.2</span><br><span class="line"></span><br><span class="line">// disconnect container from network</span><br><span class="line"></span><br><span class="line">    docker network disconnect my-bridge-network web</span><br></pre></td></tr></table></figure>
<h2 id="manage-data-in-containers"><a href="#manage-data-in-containers" class="headerlink" title="manage data in containers"></a>manage data in containers</h2><p>Learn how you can manage data inside and between your Docker containers.</p>
<p>You’re going to look at the two primary ways you can manage data with Docker Engine.</p>
<ul>
<li>Data volumes</li>
<li>Data volume containers</li>
</ul>
<h3 id="Data-volumes"><a href="#Data-volumes" class="headerlink" title="Data volumes"></a>Data volumes</h3><p>A data volume is a specially-designated directory within one or more containers that bypasses the Union File System.</p>
<blockquote>
<p>Note: The host directory is, by its nature, host-dependent. For this reason, you can’t mount a host directory from Dockerfile because built images should be portable. A host directory wouldn’t be available on all potential hosts.</p>
</blockquote>
<ul>
<li>add a data volume</li>
<li>locate a volume</li>
<li>mount a host directory as a data volume</li>
<li>mount a shared-storage volume as a data volume</li>
<li>create a volume</li>
<li>volume labels</li>
<li>mount a host file as a data volume</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">// add a data volume</span><br><span class="line"></span><br><span class="line">  docker run -d --name web -v /webapp nginx</span><br><span class="line"></span><br><span class="line">// locate a volume</span><br><span class="line"></span><br><span class="line">  docker inspect web</span><br><span class="line"></span><br><span class="line">    [...]</span><br><span class="line">    &quot;Mounts&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;Name&quot;: &quot;fac362...80535&quot;,</span><br><span class="line">            &quot;Source&quot;: &quot;/var/lib/docker/volumes/fac362...80535/_data&quot;,</span><br><span class="line">            &quot;Destination&quot;: &quot;/webapp&quot;,</span><br><span class="line">            &quot;Driver&quot;: &quot;local&quot;,</span><br><span class="line">            &quot;Mode&quot;: &quot;&quot;,</span><br><span class="line">            &quot;RW&quot;: true,</span><br><span class="line">            &quot;Propagation&quot;: &quot;&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">    [...]</span><br><span class="line"></span><br><span class="line">// mount a host directory as a data volume</span><br><span class="line"></span><br><span class="line">  docker run -d --name web -v /src/webapp:/webapp nginx</span><br><span class="line"></span><br><span class="line">// mount a shared-storage volume as a data volume</span><br><span class="line"></span><br><span class="line">  docker run -d --name web --volume-driver=nfs -v my-volume:/webapp nginx</span><br><span class="line"></span><br><span class="line">// create a volume</span><br><span class="line"></span><br><span class="line">  docker volume create -d nfs -o size=20GB my-volume</span><br><span class="line"></span><br><span class="line">// volume labels</span><br><span class="line"></span><br><span class="line">  To change a label in the container context, you can add either of two</span><br><span class="line">  suffixes :z or :Z to the volume mount. These suffixes tell Docker to relabel</span><br><span class="line">  file objects on the shared volumes. The z option tells Docker that two</span><br><span class="line">  containers share the volume content. As a result, Docker labels the content</span><br><span class="line">  with a shared content label. Shared volume labels allow all containers to</span><br><span class="line">  read/write content. The Z option tells Docker to label the content with a</span><br><span class="line">  private unshared label. Only the current container can use a private volume.</span><br><span class="line"></span><br><span class="line">// mount a host file as a data volume</span><br><span class="line"></span><br><span class="line">  docker run --rm -it -v ~/.bash_history:/root/.bash_history ubuntu /bin/bash</span><br></pre></td></tr></table></figure>
<h3 id="Data-volume-containers"><a href="#Data-volume-containers" class="headerlink" title="Data volume containers"></a>Data volume containers</h3><p>If you have some persistent data that you want to share between containers, or want to use from non-persistent containers, it’s best to create a named Data Volume Container, and then to mount the data from it.</p>
<ul>
<li>create a data volume container</li>
<li>mount the data volume in another container</li>
<li>mount the data volume in another container again</li>
<li>find and remove dangling volumes</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">// create a data volume container</span><br><span class="line"></span><br><span class="line">  docker create -v /dbdata --name dbstore training/postgres /bin/true</span><br><span class="line"></span><br><span class="line">    # shares /dbdata from the container named dbstore</span><br><span class="line"></span><br><span class="line">// mount the data volume in another container</span><br><span class="line"></span><br><span class="line">  docker run -d --volumes-from dbstore --name db1 training/postgres</span><br><span class="line"></span><br><span class="line">// mount the data volume in another container again</span><br><span class="line"></span><br><span class="line">  docker run -d --volumes-from dbstore --name db2 training/postgres</span><br><span class="line"></span><br><span class="line">// find and remove dangling volumes</span><br><span class="line"></span><br><span class="line">  docker volume ls -f dangling=true</span><br><span class="line"></span><br><span class="line">  docker volume rm &lt;volume name&gt;</span><br><span class="line"></span><br><span class="line">  Note: Docker will not warn you when removing a container without providing</span><br><span class="line">  the -v option to delete its volumes. If you remove containers without</span><br><span class="line">  using the -v option, you may end up with “dangling” volumes; volumes that</span><br><span class="line">  are no longer referenced by a container.</span><br></pre></td></tr></table></figure>
<h3 id="Backup-restore-or-migrate-data-volumes"><a href="#Backup-restore-or-migrate-data-volumes" class="headerlink" title="Backup, restore, or migrate data volumes"></a>Backup, restore, or migrate data volumes</h3><ul>
<li>backup data volume</li>
<li>restore or migrate</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">// backup data volume</span><br><span class="line"></span><br><span class="line">  docker run --rm \</span><br><span class="line">    --volumes-from dbstore -v $(pwd):/backup \</span><br><span class="line">    ubuntu tar cvf /backup/backup.tar /dbdata</span><br><span class="line"></span><br><span class="line">// restore or migrate</span><br><span class="line"></span><br><span class="line">  # step1: create new container</span><br><span class="line"></span><br><span class="line">    docker run -v /dbdata --name dbstore2 ubuntu /bin/bash</span><br><span class="line"></span><br><span class="line">  # step2: restore data</span><br><span class="line"></span><br><span class="line">    docker run --rm \</span><br><span class="line">    --volumes-from dbstore2 -v $(pwd):/backup \</span><br><span class="line">    ubuntu bash -c &quot;cd /dbdata &amp;&amp; tar xvf /backup/backup.tar --strip 1&quot;</span><br></pre></td></tr></table></figure>
<h3 id="Removing-anonymous-volumes"><a href="#Removing-anonymous-volumes" class="headerlink" title="Removing anonymous volumes"></a>Removing anonymous volumes</h3><ul>
<li>remove anonymous volumes</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// remove anonymous volume</span><br><span class="line"></span><br><span class="line">  docker run --rm -v /foo -v awesome:/bar busybox top</span><br><span class="line"></span><br><span class="line">    When the container is deleted, the --rm option instructs the Docker</span><br><span class="line">    Engine daemon to clean up anonymous volumes, and remove the container.</span><br><span class="line"></span><br><span class="line">    This command creates an anonymous /foo volume. When the container is</span><br><span class="line">    removed, the Docker Engine removes the /foo volume but not the awesome</span><br><span class="line">    volume.</span><br></pre></td></tr></table></figure>
<h3 id="Important-tips-on-using-shared-volumes"><a href="#Important-tips-on-using-shared-volumes" class="headerlink" title="Important tips on using shared volumes"></a>Important tips on using shared volumes</h3><p>Multiple containers can also share one or more data volumes. However, multiple containers writing to a single shared volume can cause data corruption. Make sure your applications are designed to write to shared data stores.</p>
<p>Data volumes are directly accessible from the Docker host. This means you can read and write to them with normal Linux tools. In most cases you should not do this as it can cause data corruption if your containers and applications are unaware of your direct access.</p>
<h2 id="store-images-on-Docker-Hub"><a href="#store-images-on-Docker-Hub" class="headerlink" title="store images on Docker Hub"></a>store images on Docker Hub</h2><p>Docker itself provides access to Docker Hub services via the docker search, pull, login, and push commands.</p>
<p>Anyone can pull public images from the Docker Hub registry, but if you would like to share your own images, then you must register first.</p>
<ul>
<li>login to docker hub</li>
<li>search for images</li>
<li>pull image</li>
<li>pushing a repository to Docker Hub</li>
<li>features of Docker Hub</li>
<li>setup automated build</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">// register at docker hub</span><br><span class="line"></span><br><span class="line">  https://hub.docker.com/</span><br><span class="line"></span><br><span class="line">// login to docker hub</span><br><span class="line"></span><br><span class="line">  docker login</span><br><span class="line"></span><br><span class="line">    # credentials stored at: $HOME/.docker/config.json</span><br><span class="line"></span><br><span class="line">// search for images</span><br><span class="line"></span><br><span class="line">  docker search centos</span><br><span class="line"></span><br><span class="line">    NAME                            DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED</span><br><span class="line">    centos                          The official build of CentOS.                   2829      [OK]</span><br><span class="line">    [...]</span><br><span class="line"></span><br><span class="line">// pull image</span><br><span class="line"></span><br><span class="line">  docker pull centos</span><br><span class="line"></span><br><span class="line">  docker pull centos:centos5</span><br><span class="line"></span><br><span class="line">// pushing a repository to Docker Hub</span><br><span class="line"></span><br><span class="line">  docker push yourname/newimage</span><br><span class="line"></span><br><span class="line">// features of Docker Hub</span><br><span class="line"></span><br><span class="line">  - Private repositories: private repositories</span><br><span class="line">  - Organizations and teams: Docker Hub lets you create organizations</span><br><span class="line">  - Automated Builds: automate the building and updating of images from GitHub or Bitbucket.  Trigger builds via a URL on Docker Hub.</span><br><span class="line">  - Webhooks: trigger an event when an image or updated image is pushed to the repository</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// setup automated build</span><br><span class="line"></span><br><span class="line">1. Create a Docker Hub account and login.</span><br><span class="line">2. Link your GitHub or Bitbucket account on the “Linked Accounts &amp; Services” page.</span><br><span class="line">3. Select “Create Automated Build” from the “Create” dropdown menu</span><br><span class="line">4. Pick a GitHub or Bitbucket project that has a Dockerfile that you want to build.</span><br><span class="line">5. Pick the branch you want to build (the default is the master branch).</span><br><span class="line">6. Give the Automated Build a name.</span><br><span class="line">7. Assign an optional Docker tag to the Build.</span><br><span class="line">8. Specify where the Dockerfile is located. The default is /.</span><br></pre></td></tr></table></figure>

                
            </div>
        </article>
    
        <article class="post-abstract">
            <div class="post-title">
                <h2><a class="post-title-link" href="/2016/11/05/2016/20161105-docker-getting-started/">Docker – Getting Started</a></h2>
            </div>
            <div class="post-meta">
                <span class="post-time">2016-11-05</span>
                
            </div>
            <div class="post-content">
                
                    <h1 id="Docker-––-Getting-Started"><a href="#Docker-––-Getting-Started" class="headerlink" title="Docker –– Getting Started"></a>Docker –– Getting Started</h1><!-- TOC depthFrom:1 depthTo:2 withLinks:0 updateOnSave:1 orderedList:0 -->
<ul>
<li>Docker –– Getting Started<ul>
<li>run hello-world from image</li>
<li>see images and containers</li>
<li>find and run whalesay image</li>
<li>build your own image</li>
<li>create a docker-hub account</li>
<li>tag, push and pull your image</li>
</ul>
</li>
</ul>
<!-- /TOC -->
<h2 id="run-hello-world-from-image"><a href="#run-hello-world-from-image" class="headerlink" title="run hello-world from image"></a>run hello-world from image</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker run hello-world</span><br><span class="line"></span><br><span class="line">Hello from Docker!</span><br></pre></td></tr></table></figure>
<h2 id="see-images-and-containers"><a href="#see-images-and-containers" class="headerlink" title="see images and containers"></a>see images and containers</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// see images</span><br><span class="line">docker images</span><br><span class="line"></span><br><span class="line">// see containers</span><br><span class="line">docker ps</span><br></pre></td></tr></table></figure>
<h2 id="find-and-run-whalesay-image"><a href="#find-and-run-whalesay-image" class="headerlink" title="find and run whalesay image"></a>find and run whalesay image</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">docker run docker/whalesay cowsay boo</span><br><span class="line">Unable to find image &apos;docker/whalesay:latest&apos; locally</span><br><span class="line">latest: Pulling from docker/whalesay</span><br><span class="line"></span><br><span class="line">e190868d63f8: Already exists</span><br><span class="line">909cd34c6fd7: Already exists</span><br><span class="line">0b9bfabab7c1: Already exists</span><br><span class="line">a3ed95caeb02: Pull complete</span><br><span class="line">00bf65475aba: Pull complete</span><br><span class="line">c57b6bcc83e3: Pull complete</span><br><span class="line">8978f6879e2f: Pull complete</span><br><span class="line">8eed3712d2cf: Pull complete</span><br><span class="line">Digest: sha256:178598e51a26abbc958b8a2e48825c90bc22e641de3d31e18aaf55f3258ba93b</span><br><span class="line">Status: Downloaded newer image for docker/whalesay:latest</span><br><span class="line"> _____</span><br><span class="line">&lt; boo &gt;</span><br><span class="line"> -----</span><br><span class="line">    \</span><br><span class="line">     \</span><br><span class="line">      \</span><br><span class="line">                    ##        .</span><br><span class="line">              ## ## ##       ==</span><br><span class="line">           ## ## ## ##      ===</span><br><span class="line">       /&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;___/ ===</span><br><span class="line">  ~~~ &#123;~~ ~~~~ ~~~ ~~~~ ~~ ~ /  ===- ~~~</span><br><span class="line">       \______ o          __/</span><br><span class="line">        \    \        __/</span><br><span class="line">          \____\______/</span><br></pre></td></tr></table></figure>
<h2 id="build-your-own-image"><a href="#build-your-own-image" class="headerlink" title="build your own image"></a>build your own image</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">// create Dockerfile</span><br><span class="line">  FROM docker/whalesay:latest</span><br><span class="line">  RUN apt-get -y update &amp;&amp; apt-get install -y fortunes</span><br><span class="line">  CMD /usr/games/fortune -a | cowsay</span><br><span class="line"></span><br><span class="line">// build image</span><br><span class="line">docker build -t docker-whale .</span><br><span class="line">  Sending build context to Docker daemon 2.048 kB</span><br><span class="line">  [...]</span><br><span class="line">  Successfully built 21d2171cd112</span><br><span class="line"></span><br><span class="line">// see image</span><br><span class="line">docker images</span><br><span class="line">  REPOSITORY                            TAG                 IMAGE ID            CREATED              SIZE</span><br><span class="line">  docker-whale                          latest              21d2171cd112        About a minute ago   275 MB</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// run image</span><br><span class="line">docker run docker-whale</span><br><span class="line"></span><br><span class="line">   ________________________________</span><br><span class="line">  / &quot;Indecision is the basis of    \</span><br><span class="line">  | flexibility&quot;                   |</span><br><span class="line">  |                                |</span><br><span class="line">  | -- button at a Science Fiction |</span><br><span class="line">  \ convention.                    /</span><br><span class="line">   --------------------------------</span><br><span class="line">      \</span><br><span class="line">       \</span><br><span class="line">        \</span><br><span class="line">                      ##        .</span><br><span class="line">                ## ## ##       ==</span><br><span class="line">             ## ## ## ##      ===</span><br><span class="line">         /&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;___/ ===</span><br><span class="line">    ~~~ &#123;~~ ~~~~ ~~~ ~~~~ ~~ ~ /  ===- ~~~</span><br><span class="line">         \______ o          __/</span><br><span class="line">          \    \        __/</span><br><span class="line">            \____\______/</span><br></pre></td></tr></table></figure>
<h2 id="create-a-docker-hub-account"><a href="#create-a-docker-hub-account" class="headerlink" title="create a docker-hub account"></a>create a docker-hub account</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// docker hub account</span><br><span class="line">frankg/frankg</span><br></pre></td></tr></table></figure>
<h2 id="tag-push-and-pull-your-image"><a href="#tag-push-and-pull-your-image" class="headerlink" title="tag, push and pull your image"></a>tag, push and pull your image</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">// list image</span><br><span class="line">docker images</span><br><span class="line">  REPOSITORY</span><br><span class="line">  docker-whale</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// tag image</span><br><span class="line">tag 21d2171cd112 frankg/docker-whale:latest</span><br><span class="line">  REPOSITORY</span><br><span class="line">  frankg/docker-whale</span><br><span class="line"></span><br><span class="line">// list image</span><br><span class="line">docker images</span><br><span class="line">    REPOSITORY</span><br><span class="line">    frankg/docker-whale</span><br><span class="line"></span><br><span class="line">// push image</span><br><span class="line">docker push frankg/docker-whale</span><br><span class="line"></span><br><span class="line">// remove image</span><br><span class="line">docker rmi -f frankg/docker-whale</span><br><span class="line"></span><br><span class="line">// pull and run image</span><br><span class="line">docker run frankg/docker-whale</span><br><span class="line"></span><br><span class="line">  Unable to find image &apos;frankg/docker-whale:latest&apos;</span><br><span class="line">  [...]</span><br><span class="line">   ________________________________________</span><br><span class="line">  / In the future, you&apos;re going to get     \</span><br><span class="line">  | computers as prizes in breakfast       |</span><br><span class="line">  | cereals. You&apos;ll throw them out because |</span><br><span class="line">  | your house will be littered with them. |</span><br><span class="line">  |                                        |</span><br><span class="line">  \ -- Robert Lucky                        /</span><br><span class="line">   ----------------------------------------</span><br><span class="line">      \</span><br><span class="line">       \</span><br><span class="line">        \</span><br><span class="line">                      ##        .</span><br><span class="line">                ## ## ##       ==</span><br><span class="line">             ## ## ## ##      ===</span><br><span class="line">         /&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;___/ ===</span><br><span class="line">    ~~~ &#123;~~ ~~~~ ~~~ ~~~~ ~~ ~ /  ===- ~~~</span><br><span class="line">         \______ o          __/</span><br><span class="line">          \    \        __/</span><br><span class="line">            \____\______/</span><br></pre></td></tr></table></figure>

                
            </div>
        </article>
    
        <article class="post-abstract">
            <div class="post-title">
                <h2><a class="post-title-link" href="/2016/09/07/2016/20160910-loopback/">Building Node apps with Loopback</a></h2>
            </div>
            <div class="post-meta">
                <span class="post-time">2016-09-07</span>
                
            </div>
            <div class="post-content">
                
                    <h2 id="What-is-LoopBack-Framework"><a href="#What-is-LoopBack-Framework" class="headerlink" title="What is LoopBack Framework"></a>What is LoopBack Framework</h2><p>LoopBack is an open source framework from IBM that enables you to quickly compose scalable APIs.</p>
<h3 id="Features"><a href="#Features" class="headerlink" title="Features"></a>Features</h3><ul>
<li>Open Source and based on Express</li>
<li>Security (xss, csrf, etc.)</li>
<li>Connectivity with ORM (mongo, mysql, other-api’s etc)</li>
<li>REST (Auto-Generate APIs from Data Models)</li>
<li>Authentication (password and social login)</li>
<li>Authorization (fine grained ACLs)</li>
<li>Swagger (web interface for your API)</li>
</ul>
<h2 id="Loopback-Documentation-and-Example-Apps"><a href="#Loopback-Documentation-and-Example-Apps" class="headerlink" title="Loopback Documentation and Example Apps"></a>Loopback Documentation and Example Apps</h2><ul>
<li><a href="https://goo.gl/gUGku6" target="_blank" rel="noopener">Documentation</a></li>
<li><a href="https://goo.gl/5DtGev" target="_blank" rel="noopener">Example Apps</a></li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">name</th>
<th style="text-align:left">descriptions</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">loopback-getting-started</td>
<td style="text-align:left">Review app part1</td>
</tr>
<tr>
<td style="text-align:left">loopback-getting-started-intermediate</td>
<td style="text-align:left">Review app part2</td>
</tr>
<tr>
<td style="text-align:left">loopback-example-database</td>
<td style="text-align:left">Database related features</td>
</tr>
<tr>
<td style="text-align:left">loopback-example-relations</td>
<td style="text-align:left">Model relations and filtering via REST</td>
</tr>
<tr>
<td style="text-align:left">loopback-example-app-logic</td>
<td style="text-align:left">How to add your own logic to a LoopBack app</td>
</tr>
<tr>
<td style="text-align:left">loopback-example-access-control</td>
<td style="text-align:left">Controlling access to your API endpoints</td>
</tr>
</tbody>
</table>
<h2 id="App-Building-Processes"><a href="#App-Building-Processes" class="headerlink" title="App Building Processes"></a>App Building Processes</h2><h3 id="loopback-getting-started"><a href="#loopback-getting-started" class="headerlink" title="loopback-getting-started"></a>loopback-getting-started</h3><ul>
<li>Create a simple API</li>
<li>Connect your API to a data source</li>
<li>Extend your API <code>(not covered here)</code></li>
<li>Add a static web page <code>(not covered here)</code></li>
<li>Add a custom Express route <code>(not covered here)</code></li>
<li>Use API Explorer</li>
</ul>
<p>See the complete process <a href="https://goo.gl/aDII6X" target="_blank" rel="noopener">here</a></p>
<pre><code>// loopback-getting-started abbreviated process

      // install loopback
      npm install -g strongloop

      // generate app
      slc loopback CoffeeShops

      // goto project directory
      cd CoffeeShops

      // add data source (mongoDB)
      slc loopback:datasource

      // generate model (CoffeeShop)
      slc loopback:model

      // create sample data (for CoffeeShop -- see https://goo.gl/2aB4lE)

          Create boot script to populate CoffeeShop data

      // start the app
      node .

      // test api explorer
      open localhost:3000/explorer      // create, read, update, delete, etc.

      // test database
      mongodb-client                    // confirm database and data
</code></pre><h3 id="loopback-getting-started-intermediate"><a href="#loopback-getting-started-intermediate" class="headerlink" title="loopback-getting-started-intermediate"></a>loopback-getting-started-intermediate</h3><p>Continuing from the previous app we will add:</p>
<ul>
<li>Relations between models.</li>
<li>Remote hooks.</li>
<li>Using access control lists to protect REST endpoints.</li>
<li>User registration and authentication</li>
<li>Using the AngularJS SDK</li>
</ul>
<p>See the complete process <a href="https://goo.gl/Ut4QNK" target="_blank" rel="noopener">here</a></p>
<pre><code>// loopback-getting-started-intermediate abbreviated process

      // goto project directory
      cd CoffeeShops

      // generate multiple models (for Review and Reviewer)
      slc loopback:model

      // create sample data (for Review and Reviewer -- see https://goo.gl/nVlZ6z)

          Update boot script to populate Review and Reviewer data

      // define multiple relations
      slc loopback:relation

          A coffee shop has many reviews; No through model and no foreign key.
          A coffee shop has many reviewers; No through model and no foreign key.
          A review belongs to a coffee shop; No foreign key.
          A review belongs to a reviewer; foreign key is publisherId.
          A reviewer has many reviews; foreign key is publisherId.

      // define multiple access controls
      slc loopback:acl

          Deny everyone all endpoints.
          Allow everyone to read reviews.
          Allow authenticated users to write a review.
          Allow the author of a review (its &quot;owner&quot;) to make any changes to it.

      // create a remote hook (see https://goo.gl/PR0YJN)

          Populate date and publisher before creating a review

      // start process manager
      slc pm
</code></pre><h2 id="Generators"><a href="#Generators" class="headerlink" title="Generators"></a>Generators</h2><table>
<thead>
<tr>
<th style="text-align:left">Command</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">slc loopback</td>
<td style="text-align:left">Application generator</td>
</tr>
<tr>
<td style="text-align:left">slc loopback:datasource</td>
<td style="text-align:left">Data source generator</td>
</tr>
<tr>
<td style="text-align:left">slc loopback:model</td>
<td style="text-align:left">Model generator</td>
</tr>
<tr>
<td style="text-align:left">slc loopback:property</td>
<td style="text-align:left">Property generator</td>
</tr>
<tr>
<td style="text-align:left">slc loopback:acl</td>
<td style="text-align:left">ACL generator</td>
</tr>
<tr>
<td style="text-align:left">slc loopback:relation</td>
<td style="text-align:left">Relation generator</td>
</tr>
<tr>
<td style="text-align:left">slc loopback:remote-method</td>
<td style="text-align:left">Remote method generator</td>
</tr>
<tr>
<td style="text-align:left">slc loopback:middleware</td>
<td style="text-align:left">Middleware generator</td>
</tr>
<tr>
<td style="text-align:left">slc loopback:boot-script</td>
<td style="text-align:left">Boot script generator</td>
</tr>
<tr>
<td style="text-align:left">slc loopback:export-api-def</td>
<td style="text-align:left">API definition generator</td>
</tr>
<tr>
<td style="text-align:left">slc loopback:swagger</td>
<td style="text-align:left">Swagger generator</td>
</tr>
</tbody>
</table>
<blockquote>
<p>The slc command has many additional sub-commands not specific to LoopBack for building, deploying, and managing Node applications. See Operating Node applications for more information and Command-line reference for the command reference.</p>
</blockquote>
<h2 id="NOTES"><a href="#NOTES" class="headerlink" title="NOTES"></a>NOTES</h2><h3 id="StrongLoop-Arc"><a href="#StrongLoop-Arc" class="headerlink" title="StrongLoop Arc"></a>StrongLoop Arc</h3><p>StrongLoop Arc is a graphical tool for building, deploying, and monitoring LoopBack applications.</p>
<blockquote>
<p>StrongLoop Arc is being deprecated and replaced watch for more info.</p>
</blockquote>
<h3 id="Environment-Specific-Configuration"><a href="#Environment-Specific-Configuration" class="headerlink" title="Environment Specific Configuration"></a>Environment Specific Configuration</h3><p>See <a href="https://goo.gl/9mE5Kt" target="_blank" rel="noopener">Environment Specific Configuration</a> for:</p>
<ul>
<li>configuration files</li>
<li>Application-wide configuration</li>
<li>Turning off stack traces</li>
<li>Disabling API Explorer</li>
<li>Customizing REST error handling</li>
<li>Exclude stack traces from HTTP responses</li>
<li>Data source configuration</li>
<li>Getting values from environment variables</li>
</ul>
<h3 id="Versioning-your-API"><a href="#Versioning-your-API" class="headerlink" title="Versioning your API"></a>Versioning your API</h3><p>You can easily add versioning to your REST API routes, based on the application “major” version in package.json.  See <a href="https://goo.gl/LSI8GG" target="_blank" rel="noopener">here</a></p>

                
            </div>
        </article>
    
</div>
<div class="paginator">
    
        
        <a class="prev" href="/page/17/">
            <i class="iconfont icon-prev"></i>
            Prev
        </a>
        
        
        <a class="next" href="/page/19/">
            Next
            <i class="iconfont icon-next"></i>
        </a>
        
    
</div>

    </div>
</div>
<footer class="footer-social">
    
    <a class="social-link" target="_blank" href="https://github.com/dearfrankg">
        <i class="iconfont icon-github"></i>
    </a>
    

    

    

    <div class="footer-copyright">
        <p class="time-line">
            &copy;
            
            
            2018
            &nbsp;<i class="iconfont icon-heart"></i>&nbsp;
            <a target="_blank" href="https://github.com/dearfrankg">Frank Gutierrez</a>
        </p>
    </div>
</footer>
</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="/js/index.js"></script>
<!-- <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> -->
<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
<script>
    

</script>
</html>
