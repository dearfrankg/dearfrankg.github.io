<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
    <title>dev notes</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/gitment.css">
    <link rel="stylesheet" href="/css/font_859455_eaq7v6w8ktj.css">
</head>

<body>
<header class="header">
    <div class="header-inner">
        <div class="header-title">

        </div>
        <nav class="header-nav">
            
            <a href="/" class="header-nav-link">
                Home
            </a>
            

            
            <a href="/archives" class="header-nav-link">
                Archives
            </a>
            

            
            <a href="/tags" class="header-nav-link">
                Tags
            </a>
            

            
        </nav>
    </div>
</header>
<header class="mobile-header">
    <div class="mobile-nav">
        <div class="mobile-nav-icon">
            <span></span>
            <span></span>
            <span></span>
        </div>
        <div class="mobile-nav-title">
            <a href="/" class="mobile-nav-title-link">Frank Gutierrez's Blog</a>
        </div>

    </div>
    <nav class="mobile-menu">
        <ul class="mobile-menu-list">
            <li class="mobile-menu-item">
                <i class="iconfont icon-home"></i>
                <a href="/" class="mobile-nav-link">Home</a>
            </li>
            <li class="mobile-menu-item">
                <i class="iconfont icon-archive"></i>
                <a href="/archives" class="mobile-nav-link">Archives</a>
            </li>
            <li class="mobile-menu-item">
                <i class="iconfont icon-tag"></i>
                <a href="/tags" class="mobile-nav-link">Tags</a>
            </li>
            <li class="mobile-menu-item">
                <i class="iconfont icon-about"></i>
                <a href="/about/" class="mobile-nav-link">About</a>
            </li>
        </ul>
    </nav>
</header>
<div class="main">
    <div class="content-inner">
        <div class="posts">
    <article class="post-whole">
        <div class="post-title">
            <h2 class="title">react testing with contracts</h2>
            <div class="post-meta">
                <span class="post-time">2017-02-11</span>
                
                <span class="post-visit"> visited：<span id="busuanzi_value_page_pv"></span></span>
            </div>
        </div>
        <div class="post-toc" id="post-toc">
    <strong class="post-toc-title">TOC</strong>
    <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#TO-BE-DEPRECATED-AFTER-I-PULL-OUT-THE-GEMS"><span class="toc-text">TO BE DEPRECATED AFTER I PULL OUT THE GEMS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TO-BE-DEPRECATED-AFTER-I-PULL-OUT-THE-GEMS-1"><span class="toc-text">TO BE DEPRECATED AFTER I PULL OUT THE GEMS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TO-BE-DEPRECATED-AFTER-I-PULL-OUT-THE-GEMS-2"><span class="toc-text">TO BE DEPRECATED AFTER I PULL OUT THE GEMS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TO-BE-DEPRECATED-AFTER-I-PULL-OUT-THE-GEMS-3"><span class="toc-text">TO BE DEPRECATED AFTER I PULL OUT THE GEMS</span></a></li></ol><li class="toc-item toc-level-2"><a class="toc-link" href="#React-Testing-Explained"><span class="toc-text">React Testing Explained</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Contracts"><span class="toc-text">Contracts</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Discovering-your-components-contract"><span class="toc-text">Discovering your components contract</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Finding-the-LockScreen’s-contract"><span class="toc-text">Finding the LockScreen’s contract</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#What’s-Worth-Testing"><span class="toc-text">What’s Worth Testing?</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Rules-of-Thumb-that-determine-if-something-is-not-worth-testing"><span class="toc-text">Rules of Thumb that determine if something is not_worth_testing:</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Setting-Up-Some-Test-Boilerplate"><span class="toc-text">Setting Up Some Test Boilerplate</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Writing-the-Tests"><span class="toc-text">Writing the Tests!</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#conditional-tests"><span class="toc-text">conditional tests</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#final-test-file"><span class="toc-text">final test file</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Maybe-not-what-you-expected"><span class="toc-text">Maybe not what you expected</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#cheat-sheet-concerns-of-most-React-components"><span class="toc-text">cheat sheet: concerns of most React components:</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#References"><span class="toc-text">References</span></a>
    <div class="back-to-top" id="back-to-top">
        <a href="javascript:void(0);">back to top</a>
    </div>
</li></div>

        <div class="post-content">
            <h3 id="TO-BE-DEPRECATED-AFTER-I-PULL-OUT-THE-GEMS"><a href="#TO-BE-DEPRECATED-AFTER-I-PULL-OUT-THE-GEMS" class="headerlink" title="TO BE DEPRECATED AFTER I PULL OUT THE GEMS"></a>TO BE DEPRECATED AFTER I PULL OUT THE GEMS</h3><h3 id="TO-BE-DEPRECATED-AFTER-I-PULL-OUT-THE-GEMS-1"><a href="#TO-BE-DEPRECATED-AFTER-I-PULL-OUT-THE-GEMS-1" class="headerlink" title="TO BE DEPRECATED AFTER I PULL OUT THE GEMS"></a>TO BE DEPRECATED AFTER I PULL OUT THE GEMS</h3><h3 id="TO-BE-DEPRECATED-AFTER-I-PULL-OUT-THE-GEMS-2"><a href="#TO-BE-DEPRECATED-AFTER-I-PULL-OUT-THE-GEMS-2" class="headerlink" title="TO BE DEPRECATED AFTER I PULL OUT THE GEMS"></a>TO BE DEPRECATED AFTER I PULL OUT THE GEMS</h3><h3 id="TO-BE-DEPRECATED-AFTER-I-PULL-OUT-THE-GEMS-3"><a href="#TO-BE-DEPRECATED-AFTER-I-PULL-OUT-THE-GEMS-3" class="headerlink" title="TO BE DEPRECATED AFTER I PULL OUT THE GEMS"></a>TO BE DEPRECATED AFTER I PULL OUT THE GEMS</h3><h2 id="React-Testing-Explained"><a href="#React-Testing-Explained" class="headerlink" title="React Testing Explained"></a>React Testing Explained</h2><p>Here are the <code>App</code> and <code>LockScreen</code> components.</p>
<figure class="highlight js"><figcaption><span>App</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> LockScreen <span class="keyword">from</span> <span class="string">'./LockScreen'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;LockScreen</span><br><span class="line">        wallpaperPath=<span class="string">'react_wallpaper.png'</span></span><br><span class="line">        userInfoMessage=<span class="string">'This is Tim'</span>s phone. If found, please give it back to him. He will be sad without it<span class="string">'</span></span><br><span class="line"><span class="string">        onUnlocked=&#123;() =&gt; alert('</span>unlocked!<span class="string">')&#125;</span></span><br><span class="line"><span class="string">      /&gt;</span></span><br><span class="line"><span class="string">    )</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><figcaption><span>LockScreen</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; PropTypes &#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> ClockDisplay <span class="keyword">from</span> <span class="string">'./ClockDisplay'</span></span><br><span class="line"><span class="keyword">import</span> TopOverlay <span class="keyword">from</span> <span class="string">'./TopOverlay'</span></span><br><span class="line"><span class="keyword">import</span> SlideToUnlock <span class="keyword">from</span> <span class="string">'./SlideToUnlock'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">LockScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> propTypes = &#123;</span><br><span class="line">    wallpaperPath: PropTypes.string,</span><br><span class="line">    userInfoMessage: PropTypes.string,</span><br><span class="line">    onUnlocked: PropTypes.func,</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;</span><br><span class="line">      wallpaperPath,</span><br><span class="line">      userInfoMessage,</span><br><span class="line">      onUnlocked,</span><br><span class="line">    &#125; = <span class="keyword">this</span>.props</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div</span><br><span class="line">        style=&#123;&#123;</span><br><span class="line">          height: <span class="string">'100%'</span>,</span><br><span class="line">          display: <span class="string">'flex'</span>,</span><br><span class="line">          justifyContent: <span class="string">'space-between'</span>,</span><br><span class="line">          flexDirection: <span class="string">'column'</span>,</span><br><span class="line">          backgroundImage: wallpaperPath ? <span class="string">`url(<span class="subst">$&#123;wallpaperPath&#125;</span>)`</span> : <span class="string">',</span></span><br><span class="line"><span class="string">          backgroundColor: '</span>black<span class="string">',</span></span><br><span class="line"><span class="string">          backgroundPosition: '</span>center<span class="string">',</span></span><br><span class="line"><span class="string">          backgroundSize: '</span>cover<span class="string">',</span></span><br><span class="line"><span class="string">        &#125;&#125;</span></span><br><span class="line"><span class="string">      &gt;</span></span><br><span class="line"><span class="string">        &lt;ClockDisplay /&gt;</span></span><br><span class="line"><span class="string">        &#123;userInfoMessage ? (</span></span><br><span class="line"><span class="string">          &lt;TopOverlay</span></span><br><span class="line"><span class="string">            style=&#123;&#123;</span></span><br><span class="line"><span class="string">              padding: '</span><span class="number">2</span>em<span class="string">',</span></span><br><span class="line"><span class="string">              marginBottom: '</span>auto<span class="string">',</span></span><br><span class="line"><span class="string">            &#125;&#125;</span></span><br><span class="line"><span class="string">          &gt;</span></span><br><span class="line"><span class="string">            &#123;userInfoMessage&#125;</span></span><br><span class="line"><span class="string">          &lt;/TopOverlay&gt;</span></span><br><span class="line"><span class="string">        ) : null&#125;</span></span><br><span class="line"><span class="string">        &lt;SlideToUnlock onSlide=&#123;onUnlocked&#125; /&gt;</span></span><br><span class="line"><span class="string">      &lt;/div&gt;</span></span><br><span class="line"><span class="string">    )</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="Contracts"><a href="#Contracts" class="headerlink" title="Contracts"></a>Contracts</h2><p> A contract defines the expected behavior of your component and what assumptions are reasonable to have about its usage. Without a clear contract, your component may be hard to understand. Writing tests is a great way to formally define your component’s contract.</p>
<p> Things that are commonly part of a contract:</p>
<ul>
<li>what it renders</li>
<li>props</li>
<li>state</li>
<li>UI interaction</li>
</ul>
<p>Things that are uncommonly part of a contract:</p>
<ul>
<li>the context the component is rendered in</li>
<li>how instance methods affect the component</li>
<li>side effects of the component lifecycle</li>
</ul>
<h3 id="Discovering-your-components-contract"><a href="#Discovering-your-components-contract" class="headerlink" title="Discovering your components contract"></a>Discovering your components contract</h3><p>To find your component’s contract, ask yourself questions like:</p>
<ul>
<li>What does my component render?</li>
<li>Does my component render different things under different circumstances?</li>
<li>When I pass a function as a prop, what does my component use it for? Does it call it, or just give it to another component? If it calls it, what does it call it with?</li>
<li>When the user interacts with my component, what happens?</li>
</ul>
<h3 id="Finding-the-LockScreen’s-contract"><a href="#Finding-the-LockScreen’s-contract" class="headerlink" title="Finding the LockScreen’s contract"></a>Finding the LockScreen’s contract</h3><p>By examining our constraints and putting them to scrutiny, we broke many of them down into multiple, smaller constraints. This is great! This will make it easier to write our test code.</p>
<ul>
<li>should render the container div</li>
<li>should contain everything else when rendering the container div</li>
<li>should render the container div with certain styles</li>
<li>should assign wallpaperPath to container-div background-image when wallpaperPath prop is defined</li>
<li>should render Clock</li>
<li>should not pass props to Clock when rendering Clock</li>
<li>should render TopOverlay when the userInfoMessage prop is defined</li>
<li>should pass userInfoMessage as children to TopOverlay when the userInfoMessage prop is defined</li>
<li>should render TopOverlay with certain styles when the userInfoMessage prop is defined</li>
<li>should not render TopOverlay when userInfoMessage prop is undefined</li>
<li>should render SlideToUnlock</li>
<li>should assign onUnlocked to SlideToUnlock onSlide prop when onUnlocked prop is defined</li>
<li>should assign onUnlocked to SlideToUnlock onSlide prop when onUnlocked prop is undefined</li>
<li>should optionally receive a wallpaperPath as a string</li>
<li>should optionally receive a userInfoMessage as a string</li>
<li>should optionally receive a onUnlocked as a function</li>
</ul>
<p>This is a good starting point for our component contract. There may be more constraints within this component’s contract, and in production code you will want to find as many as you can, but for the purposes of this example, let’s just work with these. You can always add tests later if you discover additional constraints.</p>
<h3 id="What’s-Worth-Testing"><a href="#What’s-Worth-Testing" class="headerlink" title="What’s Worth Testing?"></a>What’s Worth Testing?</h3><p>Some of these constraints are worth testing, and others are not.</p>
<h4 id="Rules-of-Thumb-that-determine-if-something-is-not-worth-testing"><a href="#Rules-of-Thumb-that-determine-if-something-is-not-worth-testing" class="headerlink" title="Rules of Thumb that determine if something is not_worth_testing:"></a>Rules of Thumb that determine if something is not_worth_testing:</h4><ul>
<li>duplicates app code? This makes it brittle.</li>
<li>duplicates library code?</li>
<li>is this an internal concern?  Can it be affected by only the public api?</li>
</ul>
<p>These are only rules of thumb, so be careful not to use them to justify not testing something just because it’s hard. <strong>Often, things that seem hard to test are the most important to test</strong>, because the code under test is making many assumptions about the rest of the application.</p>
<p>Let’s find out which tests we can eliminate with our rules:</p>
<ul>
<li>Eliminate <code>prop tests</code> because it duplicates app code<br>it is already covered in React’s PropTypes system.</li>
<li>Eliminate <code>certain styles test</code> because it duplicates app code making it brittle<br>changing styles in the app would require same changes in tests</li>
</ul>
<p>Here’s what we’re left with:</p>
<ul>
<li>should render the container div</li>
<li>should contain everything else when rendering the container div</li>
<li>should assign wallpaperPath to container-div background-image when wallpaperPath prop is defined</li>
<li>should render Clock</li>
<li>should not pass props to Clock when rendering Clock</li>
<li>should render TopOverlay when the userInfoMessage prop is defined</li>
<li>should pass userInfoMessage as children to TopOverlay when the userInfoMessage prop is defined</li>
<li>should not render TopOverlay when userInfoMessage prop is undefined</li>
<li>should render SlideToUnlock</li>
<li>should assign onUnlocked to SlideToUnlock onSlide prop when onUnlocked prop is defined</li>
<li>should assign onUnlocked to SlideToUnlock onSlide prop when onUnlocked prop is undefined</li>
</ul>
<h2 id="Setting-Up-Some-Test-Boilerplate"><a href="#Setting-Up-Some-Test-Boilerplate" class="headerlink" title="Setting Up Some Test Boilerplate"></a>Setting Up Some Test Boilerplate</h2><p>Let’s start scaffolding out a test for this component. I will be using <code>Jest</code> with <code>enzyme</code> in my tests. Jest works great with React and is also the test runner included in apps created with <code>create-react-app</code>, so you may already be set up to use it. Enzyme is a mature React testing library that works in both node and the browser.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> &#123; mount &#125; <span class="keyword">from</span> <span class="string">'enzyme'</span></span><br><span class="line"><span class="keyword">import</span> LockScreen <span class="keyword">from</span> <span class="string">'./LockScreen'</span></span><br><span class="line"></span><br><span class="line">describe(<span class="string">'LockScreen'</span>, () =&gt; &#123;</span><br><span class="line">  <span class="keyword">let</span> props</span><br><span class="line">  <span class="keyword">let</span> mountedLockScreen</span><br><span class="line">  <span class="keyword">const</span> lockScreen = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!mountedLockScreen) &#123;</span><br><span class="line">      mountedLockScreen = mount(</span><br><span class="line">        &lt;LockScreen &#123;...props&#125; /&gt;</span><br><span class="line">      )</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> mountedLockScreen</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  beforeEach(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    props = &#123;</span><br><span class="line">      wallpaperPath: <span class="literal">undefined</span>,</span><br><span class="line">      userInfoMessage: <span class="literal">undefined</span>,</span><br><span class="line">      onUnlocked: <span class="literal">undefined</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    mountedLockScreen = <span class="literal">undefined</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// All tests will go here</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="Writing-the-Tests"><a href="#Writing-the-Tests" class="headerlink" title="Writing the Tests!"></a>Writing the Tests!</h3><h4 id="conditional-tests"><a href="#conditional-tests" class="headerlink" title="conditional tests"></a>conditional tests</h4><p>When the test has words in it like <code>if</code> or <code>when</code> that is an indicator of a conditional test. When we need to describe behavior that only occurs within a certain condition, we can describe that condition, and then use beforeEach within that describe to set that condition up.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">describe(<span class="string">"when userInfoMessage prop exists"</span>, () =&gt; &#123;</span><br><span class="line">  beforeEach(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    props.userInfoMessage = <span class="string">"This is my favorite phone!"</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  it(<span class="string">"should render TopOverlay"</span>, () =&gt; &#123;</span><br><span class="line">    expect(lockScreen().find(TopOverlay).length).toBe(<span class="number">1</span>)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  it(<span class="string">"should pass userInfoMessage as children to TopOverlay"</span>, () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> topOverlay = lockScreen().find(TopOverlay)</span><br><span class="line">    expect(topOverlay.props().children).toBe(props.userInfoMessage)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>This will leave our test outline looking like this:</p>
<ul>
<li>should render the container div</li>
<li>when rendering the container div<ul>
<li>should contain everything else</li>
</ul>
</li>
<li>when wallpaperPath prop is defined<ul>
<li>should assign wallpaperPath to container-div background-image</li>
</ul>
</li>
<li>should render Clock</li>
<li>when rendering Clock<ul>
<li>should not pass props to Clock</li>
</ul>
</li>
<li>when the userInfoMessage prop is defined<ul>
<li>should render TopOverlay</li>
<li>should pass userInfoMessage as children to TopOverlay</li>
</ul>
</li>
<li>when userInfoMessage prop is undefined<ul>
<li>should not render TopOverlay</li>
</ul>
</li>
<li>should render SlideToUnlock</li>
<li>when onUnlocked prop is defined<ul>
<li>should assign onUnlocked to SlideToUnlock onSlide prop</li>
</ul>
</li>
<li>when onUnlocked prop is undefined<ul>
<li>should assign onUnlocked to SlideToUnlock onSlide prop</li>
</ul>
</li>
</ul>
<h4 id="final-test-file"><a href="#final-test-file" class="headerlink" title="final test file"></a>final test file</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line">it(<span class="string">'should render the container div'</span>, () =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> divs = lockScreen().find(<span class="string">'div'</span>)</span><br><span class="line">  expect(divs.length).toBeGreaterThan(<span class="number">0</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">describe(<span class="string">"when rendering the container div"</span>, () =&gt; &#123;</span><br><span class="line">  it(<span class="string">"contains everything else that gets rendered"</span>, () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> divs = lockScreen().find(<span class="string">"div"</span>)</span><br><span class="line">    <span class="comment">// When using .find, enzyme arranges the nodes in order such</span></span><br><span class="line">    <span class="comment">// that the outermost node is first in the list. So we can</span></span><br><span class="line">    <span class="comment">// use .first() to get the outermost div.</span></span><br><span class="line">    <span class="keyword">const</span> wrappingDiv = divs.first()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Enzyme omits the outermost node when using the .children()</span></span><br><span class="line">    <span class="comment">// method on lockScreen(). This is annoying, but we can use it</span></span><br><span class="line">    <span class="comment">// to verify that wrappingDiv contains everything else this</span></span><br><span class="line">    <span class="comment">// component renders.</span></span><br><span class="line">    expect(wrappingDiv.children()).toEqual(lockScreen().children())</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">describe(<span class="string">"when wallpaperPath prop is defined"</span>, () =&gt; &#123;</span><br><span class="line">  beforeEach(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    props.wallpaperPath = <span class="string">"some/image.png"</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  it(<span class="string">"should assign wallpaperPath to container-div background-image"</span>, () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> wrappingDiv = lockScreen().find(<span class="string">"div"</span>).first()</span><br><span class="line">    expect(wrappingDiv.props().style.backgroundImage).toBe(<span class="string">`url(<span class="subst">$&#123;props.wallpaperPath&#125;</span>)`</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">it(<span class="string">"should render Clock"</span>, () =&gt; &#123;</span><br><span class="line">  expect(lockScreen().find(ClockDisplay).length).toBe(<span class="number">1</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">describe(<span class="string">"when rendering Clock"</span>, () =&gt; &#123;</span><br><span class="line">  it(<span class="string">"should not pass props to Clock"</span>, () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> clockDisplay = lockScreen().find(ClockDisplay)</span><br><span class="line">    expect(<span class="built_in">Object</span>.keys(clockDisplay.props()).length).toBe(<span class="number">0</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">describe(<span class="string">"when the userInfoMessage prop is defined"</span>, () =&gt; &#123;</span><br><span class="line">  beforeEach(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    props.userInfoMessage = <span class="string">"This is my favorite phone!"</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  it(<span class="string">"should render TopOverlay"</span>, () =&gt; &#123;</span><br><span class="line">    expect(lockScreen().find(TopOverlay).length).toBe(<span class="number">1</span>)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  it(<span class="string">"should pass userInfoMessage as children to TopOverlay"</span>, () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> topOverlay = lockScreen().find(TopOverlay)</span><br><span class="line">    expect(topOverlay.props().children).toBe(props.userInfoMessage)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">describe(<span class="string">"when userInfoMessage prop is undefined"</span>, () =&gt; &#123;</span><br><span class="line">  beforeEach(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    props.userInfoMessage = <span class="literal">undefined</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  it(<span class="string">"should not render TopOverlay"</span>, () =&gt; &#123;</span><br><span class="line">    expect(lockScreen().find(TopOverlay).length).toBe(<span class="number">0</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">it(<span class="string">"should render SlideToUnlock"</span>, () =&gt; &#123;</span><br><span class="line">  expect(lockScreen().find(SlideToUnlock).length).toBe(<span class="number">1</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">describe(<span class="string">"when onUnlocked prop is defined"</span>, () =&gt; &#123;</span><br><span class="line">  beforeEach(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    props.onUnlocked = jest.fn()</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  it(<span class="string">"should assign onUnlocked to SlideToUnlock onSlide prop"</span>, () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> slideToUnlock = lockScreen().find(SlideToUnlock)</span><br><span class="line">    expect(slideToUnlock.props().onSlide).toBe(props.onUnlocked)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">describe(<span class="string">"when onUnlocked prop is undefined"</span>, () =&gt; &#123;</span><br><span class="line">  beforeEach(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    props.onUnlocked = <span class="literal">undefined</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  it(<span class="string">"should assign onUnlocked to SlideToUnlock onSlide prop"</span>, () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> slideToUnlock = lockScreen().find(SlideToUnlock)</span><br><span class="line">    expect(slideToUnlock.props().onSlide).not.toBeDefined()</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="Maybe-not-what-you-expected"><a href="#Maybe-not-what-you-expected" class="headerlink" title="Maybe not what you expected"></a>Maybe not what you expected</h2><p>You may have expected our test cases to end up as something like:</p>
<ul>
<li>When dragging the slide-to-unlock handle all the way to the right<br>then the unlock callback is called</li>
<li>When dragging the slide-to-unlock handle partway to the right<br>then releases it, the handle is animated back to its original position</li>
<li>The clock at the top of the screen should always show the current time</li>
</ul>
<p>This intuition is natural. From an application perspective, these are some of the most noticeable features. However, we didn’t end up writing tests for any of that functionality. Why? They were not the concern of LockScreen.</p>
<p>The features described above are the concerns of SlideToUnlock and ClockDisplay, so tests around those features would go in the tests for those components, not here.</p>
<p>Because React components are reusable units, unit tests are a natural fit for them. And when unit testing, you should only test what your actual unit cares about. It is better to see the trees than the forest when writing React component tests.</p>
<h4 id="cheat-sheet-concerns-of-most-React-components"><a href="#cheat-sheet-concerns-of-most-React-components" class="headerlink" title="cheat sheet: concerns of most React components:"></a>cheat sheet: concerns of most React components:</h4><ul>
<li>What do I do with the props I receive?</li>
<li>What components do I render?</li>
<li>What do I pass to rendered components?</li>
<li>Do I ever keep anything in state?</li>
<li>Do I invalidate state when receiving new props?</li>
<li>When do I update state?</li>
<li>If a user interacts with me, what do I do?</li>
<li>If a child component calls a callback I passed to it, what do I do?</li>
<li>Does anything happen when I’m mounted? When I’m unmounted?</li>
</ul>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul>
<li><a href="https://goo.gl/B5mXvu" target="_blank" rel="noopener">The Right Way to Test React Components</a></li>
</ul>

        </div>
        
        <div class="post-tag">
            
            <a class="tag" href="/tags/react-testing/" title="react testing">react testing</a>
            
        </div>
        
    </article>
</div>
<div class="paginator">
    
        
            <a class="prev" href="/2017/02/22/20170222-react-tdd-done-right/">
                <i class="iconfont icon-prev"></i>
                <span class="nav-default">react TDD done right</span>
                <span class="nav-mobile">Prev</span>
            </a>
        
        
            <a class="next" href="/2017/02/09/20170210-mongodb/">
                <span class="nav-default">locking down mongodb</span>
                <span class="nav-mobile">Next</span>
                <i class="iconfont icon-next"></i>
            </a>
        
    
</div>
<div id="comment-container"></div>
    </div>
</div>
<footer class="footer-social">
    
    <a class="social-link" target="_blank" href="https://github.com/dearfrankg">
        <i class="iconfont icon-github"></i>
    </a>
    

    

    

    <div class="footer-copyright">
        <p class="time-line">
            &copy;
            
            
            2018
            &nbsp;<i class="iconfont icon-heart"></i>&nbsp;
            <a target="_blank" href="https://github.com/iJinxin">Frank Gutierrez</a>
        </p>
        <p class="theme-info">
            Powered by <a target="_blank" href="https://hexo.io">Hexo</a>  |  Theme -
            <a target="_blank" href="https://github.com/iJinxin/hexo-theme-sky">Sky</a>
        </p>
    </div>
</footer>
</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="/js/index.js"></script>
<!-- <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> -->
<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
<script>
    

</script>
</html>
